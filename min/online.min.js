(function(a){a.internetConnection=a.internetConnection||{},a.internetConnection.addEvent=function(a,b,c){window.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c)};var b=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");a.internetConnection.onInternetAsyncStatus=function(){if(b.readyState==4)try{a.internetConnection.processXmlhttpStatus()}catch(c){a.internetConnection.fireHandlerDependOnStatus(!1),a.onLine=!1}},a.internetConnection.checkConnectionWithRequest=function(c){if(b!=null){b=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP"),c===undefined?b.onreadystatechange=this.onInternetAsyncStatus:b.onreadystatechange=undefined,c===undefined&&(c=!0);var d=a.onLineCheckURL();b.open("HEAD",d,c),b.send();if(c===!1)return a.internetConnection.processXmlhttpStatus(),a.onLine}},a.internetConnection.processXmlhttpStatus=function(){var c=a.internetConnection.verifyStatus(b.status);a.internetConnection.fireHandlerDependOnStatus(c),a.onLine=c},a.internetConnection.verifyStatus=function(a){return a>=200&&a<300||a===304},a.internetConnection.fireHandlerDependOnStatus=function(b){b===!0&&a.onLineHandler!==undefined&&(a.onLine!==!0||a.internetConnection.handlerFired===!1)&&a.onLineHandler(),b===!1&&a.offLineHandler!==undefined&&(a.onLine!==!1||a.internetConnection.handlerFired===!1)&&a.offLineHandler(),a.internetConnection.handlerFired=!0},a.internetConnection.startCheck=function(){setInterval("window.internetConnection.checkConnectionWithRequest()",a.onLineCheckTimeout)},a.internetConnection.stopCheck=function(){clearInterval("window.internetConnection.checkConnectionWithRequest()",a.onLineCheckTimeout)},a.checkOnLine=function(){a.internetConnection.checkConnectionWithRequest(!1)},a.onLineCheckURL=function(){return"http://www.pixelsresearch.com/online.php?r="+Math.random()},a.onLineCheckTimeout=5e3,a.checkOnLine(),a.internetConnection.startCheck(),a.internetConnection.handlerFired=!1,a.internetConnection.addEvent(a,"load",function(){a.internetConnection.fireHandlerDependOnStatus(a.onLine)}),a.internetConnection.addEvent(a,"online",function(){window.internetConnection.checkConnectionWithRequest()}),a.internetConnection.addEvent(a,"offline",function(){window.internetConnection.checkConnectionWithRequest()})})(window);